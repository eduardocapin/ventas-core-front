<mat-drawer-container class="screen" autosize>
  <div class="">
    <div class="d-flex justify-content-between m-3 py-3">
      <h1 class="mb-0">
        <img class="icon-title" src="assets/images/iconos/clientes-icon-dark.svg" alt="Clientes" matListItemIcon />
        <span class=" mb-0 ps-2 color-dark page-heading">Clientes</span>
      </h1>
      <div class="boton-filtro d-flex gap-2 align-self-start me-3">
        <button matTooltip="Ver en Mapa" class="btn map-button d-flex justify-content-center align-items-center gap-2"
          (click)="verEnMapa()">
          <mat-icon>location_on</mat-icon>
        </button>
        <button matTooltip="Ver filtros" type="button" class="btn btn-secondary pb-0 pl-0" (click)="drawer.toggle()">
          <mat-icon class="p-0 m-0">filter_list_alt</mat-icon>
        </button>
      </div>
    </div>


    <div class="m-3">
      <!-- tabla -->
      <div class="table-responsive">
        <table class="table table-hover">
          <!-- Checkbox Column -->
          <thead>
            <tr>
              <th class="th-checkbox text-center">
                <input type="checkbox" class="form-check-input" (change)="masterToggle()" [checked]="selection.hasValue() && isAllSelected()"
                  [indeterminate]="selection.hasValue() && !isAllSelected()">
              </th>
              <th scope="col">C贸digo</th>
              <th scope="col">Nombre</th>
              <th scope="col">Provincia</th>
              <th scope="col">Poblaci贸n</th>
              <th scope="col">C.P.</th>
              <th scope="col">Direcci贸n</th>
              <th scope="col" class="text-center">Ficha</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let row of dataSource.data">
              <tr>
                <td class="text-center">
                  <input type="checkbox" class="form-check-input" (click)="$event.stopPropagation()" (change)="selection.toggle(row)"
                    [checked]="selection.isSelected(row)" [disabled]="isCheckboxDisabled(row)">
                </td>
                <td>{{ row.customer_ERP_id }}</td>
                <td [title]="row.name">
                  {{ row.name }}
                </td>
                <td [title]="row.province">
                  {{ row.province }}
                </td>
                <td [title]="row.city">
                  {{ row.city }}
                </td>
                <td>{{ row.pc != 0 ? row.pc : "" }}</td>
                <td [title]="row.address">
                  {{ row.address }}
                </td>
                <td class="text-center">
                  <button class="btn btn-link p-0" (click)="editClient(row.id)" title="Ficha">
                    <i class="bi bi-eye"></i>
                  </button>
                </td>
              </tr>
  
            </ng-container>
          </tbody>
        </table>
      
        <!-- Paginador -->
      </div>
      <!-- paginator -->
      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          <li class="page-item">
            <a class="page-link"aria-label="First">
              <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
          </li>
          <li class="page-item">
            <a class="page-link" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
          <!-- Page numbers here -->
          <li class="page-item">
            <a class="page-link">1</a>
          </li>
          <li class="page-item">
            <a class="page-link">2</a>
          </li>
          <li class="page-item">
            <a class="page-link">3</a>
          </li>
          <li class="page-item">
            <a class="page-link" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
          <li class="page-item">
            <a class="page-link" aria-label="Last">
              <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>



  </div>
  <mat-drawer #drawer id="drawer" class="py-5 filtro-container d-flex flex-column container" mode="over" position="end">
    <div class="p-3 pt-0 bg-blanco">
      <div class="bg-blanco sticky py-3">
        <div class="d-flex align-items-center my-3 ">
          <img src="../../../assets/images/iconos/filtros-icon.svg" alt="" width="32" height="32" alt="filtro"
            class="me-2 icono-svg">
          <h2 class="my-0">Filtro de clientes</h2>
        </div>
        <div class="col-12 justify-content-end gap-2 d-flex mt-2">
          <button mat-raised-button color="light" type="submit" (click)="applyComplexFilter()">Filtrar</button>
          <button mat-raised-button color="light" type="button" (click)="filtroReset()" mat-button>Limpiar</button>
          <button mat-raised-button color="light" type="button" (click)="drawer.toggle()" mat-button>Cancelar</button>
        </div>
      </div>
      <form [formGroup]="form" (ngSubmit)="applyComplexFilter()" class="col-12 d-flex flex-column">
        <div class="d-flex flex-column">
          <div>
            <mat-form-field subscriptSizing="dynamic" class="col-12 mb-2">
              <mat-label>Periodo de ventas</mat-label>
              <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                <input formControlName="start" matStartDate placeholder="Desde">
                <input formControlName="end" matEndDate placeholder="Hasta">
              </mat-date-range-input>
              <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-date-range-picker #picker></mat-date-range-picker>
            </mat-form-field>

            <mat-form-field *ngIf="s1.length>0" subscriptSizing="dynamic" class="mb-2 col-12">
              <mat-label>{{s1[0].name}}</mat-label>
              <mat-select formControlName="segmentacion1FilterControl" multiple>
                <mat-option *ngFor="let s of s1" [value]="s.segmentation_value_id">{{s.segmentation_value}}</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field *ngIf="s2.length>0" subscriptSizing="dynamic" class="mb-2 col-12">
              <mat-label>{{s2[0].name}}</mat-label>
              <mat-select formControlName="segmentacion2FilterControl" multiple>
                <mat-option *ngFor="let s of s2" [value]="s.segmentation_value_id">{{s.segmentation_value}}</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field *ngIf="s3.length>0" subscriptSizing="dynamic" class="mb-2 col-12">
              <mat-label>{{s3[0].name}}</mat-label>
              <mat-select formControlName="segmentacion3FilterControl" multiple>
                <mat-option *ngFor="let s of s3" [value]="s.segmentation_value_id">{{s.segmentation_value}}</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field subscriptSizing="dynamic" class="mb-2 col-12" matTooltip="Introduzca el nombre del cliente">
              <mat-label>Cliente</mat-label>
              <input formControlName="cliente" matInput>
            </mat-form-field>

            <mat-form-field subscriptSizing="dynamic" class="mb-2 col-12">
              <mat-label>Provincia</mat-label>
              <mat-select formControlName="provinciaFilterControl" multiple>
                <mat-option *ngFor="let name of provinciaList" [value]="name">{{name}}</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field subscriptSizing="dynamic" class="mb-2 col-12">
              <mat-label>Poblaci贸n</mat-label>
              <mat-select formControlName="poblacionFilterControl" multiple>
                <mat-option *ngFor="let name of poblacionList" [value]="name">{{name}}</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field subscriptSizing="dynamic" class="mb-2 col-12">
              <mat-label>Vendedor</mat-label>
              <mat-select formControlName="agenteFilterControl" multiple>
                <mat-option *ngFor="let agente of agenteList" [value]="agente.id">{{agente.name}}</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field subscriptSizing="dynamic" class="mb-2 col-12">
              <mat-label>Familia</mat-label>
              <mat-select formControlName="familiaFilterControl" multiple>
                <mat-option *ngFor="let familia of familiaList" [value]="familia">{{familia}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
      </form>
    </div>
  </mat-drawer>
</mat-drawer-container>